
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>配置apache+svn+trac - Linux系统管理</title>
  <meta name="author" content="wgzhao">

  
  <meta name="description" content="以前做一些小的项目，没有怎么用到svn之类的版本控制软件，因为项目本身就很小，几十个文件，基本上也没有太多的改动。所以都是采用直接备份文件方式来防止工作间的文件丢失。 这次自己想做的一个小东西，虽然不大，但是希望把开发过程正规起来，不能总是采用远古的作坊式了，为了直接一步和国际流行的开发方式接轨， &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://wgzhao.github.io/2007/08/29/configure-apache-svn-trac">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="/atom.xml" rel="alternate" title="Linux系统管理" type="application/atom+xml">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
  <script>!window.jQuery && document.write(unescape('%3Cscript src="./javascripts/libs/jquery.min.js"%3E%3C/script%3E'))</script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="//fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="//fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">

  

</head>

<body   >
  <header role="banner"><hgroup>
  <h1><a href="/">Linux系统管理</a></h1>
  
    <h2>关注Linux系统管理，运维开发以及大数据</h2>
  
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="https://www.google.com.hk/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:wgzhao.github.io" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/">Blog</a></li>
  <li><a href="/blog/archives">Archives</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div>
<article class="hentry" role="article">
  
  <header>
    
      <h1 class="entry-title">配置apache+svn+trac</h1>
    
    
      <p class="meta">
        








  


<time datetime="2007-08-29T00:00:00+08:00" pubdate data-updated="true"></time>
        
           | <a href="#disqus_thread"
             data-disqus-identifier="http://wgzhao.github.io">Comments</a>
        
      </p>
    
  </header>


<div class="entry-content"><p>以前做一些小的项目，没有怎么用到svn之类的版本控制软件，因为项目本身就很小，几十个文件，基本上也没有太多的改动。所以都是采用直接备份文件方式来防止工作间的文件丢失。</p>

<p>这次自己想做的一个小东西，虽然不大，但是希望把开发过程正规起来，不能总是采用远古的作坊式了，为了直接一步和国际流行的开发方式接轨，这次我直接使用了目前比较流行的源代码浏览工具&mdash;trac。下面是我的配置过程，和大家分享。</p>

<!--more-->


<ol>
<li>首先需要配置SVN，这是核心和基础，只有设置好了SVN才有可能做下面的过程。
不过SVN还是挺好用的，步骤也简洁：
     [root@mlsx home]#svnadmin create /data/ytqpki
     [root@mlsx home]#svn import /var/www/html/app file:///data/ytqpki -m &ldquo;initial&rdquo; 新增 /var/www/html/app/vendors
     新增 /var/www/html/app/vendors/empty
     新增 /var/www/html/app/tmp
     新增 /var/www/html/app/tmp/tests
     &hellip;&hellip;&hellip;&hellip;&hellip;</li>
</ol>


<p>第一个命令创建仓库，第二个命令导入初始化的文件。
当然你还可以继续导入，导入后，源文件就可以删除了。</p>

<p>这是建立仓库的过程，如果要开始编写代码，你还需要创建自己的第一个版本代码，也就是到处一份程序。</p>

<pre><code>    [root@mlsx home]# svn co file:///data/ytqpki /home/htdocs/
    A /home/htdocs/app
    A /home/htdocs/app/tmp
    A /home/htdocs/app/tmp/tests
    A /home/htdocs/app/tmp/tests/empty
    A /home/htdocs/app/tmp/cache
    ……
</code></pre>

<p><code>/home/htdocs/</code>就是现在的工作目录了，所有代码的增加修改都在这里执行，需要提交，就使用svn up,svn add,svn
ci。更多的使用方法可以参考有关SVN的指南。</p>

<ol>
<li><p>安装和配置apache+svn<br/>
对于Linux系统而言，apache都是预安装好了，不过需要检查是否安装了<code>mod_dav_svn</code>这个模块，如果没有，需要安装上。注意：<code>mod_dav_svn</code>模块的版本号应该和subversion的版本号一致。<br/>
安装完成后，编辑<code>/etc/httpd/conf.d/subversion.conf</code>文件，再最后加上下面几行</p>

<pre><code>  DAV svn
  SVNParentPath /data
  #
  # # Limit write permission to list of valid users.

  # Require SSL connection for password protection.
  # SSLRequireSSL
  #
  AuthType Basic
  AuthName “Authorization Realm”
  AuthUserFile /etc/svnpwdfile
  Require valid-user 
</code></pre></li>
</ol>


<p>然后，我们htpasswd创建<code>/etc/svnpawdfile</code>文件</p>

<pre><code>    [root@mlsx ~]# htpasswd -c /etc/snvpwdfile admin
    New password:
    Re-type new password:
    Adding password for user admin
    [root@mlsx ~]# htpasswd /etc/snvpwdfile mlsx
    New password:
    Re-type new password:
    Adding password for user mlsx
</code></pre>

<p>OK，现在重启你的apache，访问<a href="http://localhost/repos/ytqpki%E7%9C%8B%E7%9C%8B%E3%80%82  ">http://localhost/repos/ytqpki%E7%9C%8B%E7%9C%8B%E3%80%82  </a>
如果得到下面类似的界面，那么svn访问表示成功了。</p>

<p><img src="/uploads/screen1.png" alt="image" /></p>

<p>这个时候，你也可以使用通过http方式取得svn仓库内的文档了。</p>

<pre><code>    [root@mlsx ~]# svn co http://localhost/repos/ytqpki/app /tmp/
    A /tmp/tmp
    A /tmp/tmp/tests
    A /tmp/tmp/tests/empty
    A /tmp/tmp/cache
    A /tmp/tmp/cache/persistent
    A /tmp/tmp/cache/persistent/empty
    A /tmp/tmp/cache/models
    A /tmp/tmp/cache/models/default_admins
    …….
</code></pre>

<ol>
<li><p>配置trac
<a href="http://trac.edgewall.org/">trac</a>是一个非常优秀的源代码浏览工具，现在也很流行。<br/>
安装trac之前，还需要安装一些其他东西，首先是python，这个一般都安装了，其次是<a href="http://www.clearsilver.net/">ClearSilver</a>，最后是一个能够被python支持的数据库，默认是<a href="http://www.sqlite.org/">SQLite</a>。
上面的要求，一般来说，只有ClearSilver没有安装，下载最新的版本，分别执行<code>./configure --with-python=/usr/bin/python ; make; make install</code>就搞定了。 <br/>
然后下载最新的trac程序，解压，执行下面的指令<br/>
<code>./setup.py install</code><br/>
安装完成后,开始配置</p>

<pre><code>  [root@mlsx trac-0.10.4]# trac-admin /home/ytqpki initenv
  Creating a new Trac environment at /home/ytqpki
  Trac will first ask a few questions about your environment
  in order to initalize and prepare the project database.

  Please enter the name of your project.
  This name will be used in page titles and descriptions.

  Project Name [My Project]&gt; ytqpki

  Please specify the connection string for the database to use.
  By default, a local SQLite database is created in the environment
  directory. It is also possible to use an already existing
  PostgreSQL database (check the Trac documentation for the exact
  connection string syntax).

  Database connection string [sqlite:db/trac.db]&gt;

  Please specify the type of version control system,
  By default, it will be svn.

  If you don't want to use Trac with version control integration,
  choose the default here and don't specify a repository directory.
  in the next question.

  Repository type [svn]&gt;

  Please specify the absolute path to the version control
  repository, or leave it blank to use Trac without a repository.
  You can also set the repository location later.

  Path to repository [/path/to/repos]&gt; /data/ytqpki

  Please enter location of Trac page templates.
  Default is the location of the site-wide templates installed with Trac.

  Templates directory [/usr/share/trac/templates]&gt;

  Creating and Initializing Project
  Installing default wiki pages
  /usr/share/trac/wiki-default/TracFastCgi =&gt; TracFastCgi
  /usr/share/trac/wiki-default/TracIni =&gt; TracIni
  /usr/share/trac/wiki-default/TracReports =&gt; TracReports
  /usr/share/trac/wiki-default/TracTickets =&gt; TracTickets
  /usr/share/trac/wiki-default/TracSearch =&gt; TracSearch
  /usr/share/trac/wiki-default/TracModPython =&gt; TracModPython
  /usr/share/trac/wiki-default/WikiRestructuredTextLinks =&gt; WikiRestructuredTextLinks
  /usr/share/trac/wiki-default/InterTrac =&gt; InterTrac
  /usr/share/trac/wiki-default/CamelCase =&gt; CamelCase
  /usr/share/trac/wiki-default/TracBrowser =&gt; TracBrowser
  /usr/share/trac/wiki-default/WikiNewPage =&gt; WikiNewPage
  /usr/share/trac/wiki-default/TracAccessibility =&gt; TracAccessibility
  /usr/share/trac/wiki-default/InterWiki =&gt; InterWiki
  /usr/share/trac/wiki-default/TracNotification =&gt; TracNotification
  /usr/share/trac/wiki-default/TracLinks =&gt; TracLinks
  /usr/share/trac/wiki-default/TracCgi =&gt; TracCgi
  /usr/share/trac/wiki-default/TracRevisionLog =&gt; TracRevisionLog
  /usr/share/trac/wiki-default/WikiFormatting =&gt; WikiFormatting
  /usr/share/trac/wiki-default/TracAdmin =&gt; TracAdmin

  Warning:

  You should install the SVN bindings

  ———————————————————————
  Project environment for 'ytqpki' created.

  You may now configure the environment by editing the file:

  /home/ytqpki/conf/trac.ini

  If you'd like to take this new project environment for a test drive,
  try running the Trac standalone web server `tracd`:

  tracd –port 8000 /home/ytqpki

  Then point your browser to http://localhost:8000/ytqpki.
  There you can also browse the documentation for your installed
  version of Trac, including information on further setup (such as
  deploying Trac to a real web server).

  The latest documentation can also always be found on the project
  website:

  http://trac.edgewall.org/

  Congratulations!
</code></pre></li>
</ol>


<p>如果最后出现类似上面的信息,表示配置成功,trac可以独立运行,也可以集成到apache里,我们先看独立运行的方式
<code>tracd --port 8000 /home/ytqpki</code>
打开浏览器,访问<a href="http://localhost:8000/ytqpki">http://localhost:8000/ytqpki</a>
应该可以trac的默认首页,类似下面这样:</p>

<p><img src="/uploads/screen2.png" alt="image" /></p>

<ol>
<li><p>集成trac到apache<br/>
把trac集成的到apache有很多方法,可以使用<code>mod_python</code>模块,可以使用cgi模块或者<code>fast-cgi</code>模块.<code>mod_python</code>我配置了一下,没有成功,于是改用了cgi模式<br/>
这个方法比较简单.如果你需要速度快一点,那使用fast-cgi好了.<br/>
首先把trac源代码目录中<code>cgi-bin</code>目下的两个文件拷贝到你期望的地方,比如<code>/var/www/cgi-bin</code>.我这里是放到<code>/home/cgi-bin</code>目录下的.
然后增加<code>/etc/httpd/conf.d/trac.conf</code>文件,内容如下</p>

<pre><code>  ScriptAlias /trac /home/cgi-bin/trac.fcgi

  # Trac needs to know where the database is located

  SetEnv TRAC_ENV /home/ytqpki


  AuthType Basic
  AuthName “Trac”
  AuthUserFile /etc/svnpwdfile
  Require valid-user
</code></pre></li>
</ol>


<p>如果你使用的是cgi模式,那么把第一行的<code>trac.fcgi</code>,修改成<code>trac.cgi</code><br/>
密码文件我们和svn共享,这样就只需要管理一套密码了.<br/>
保存,退出,重启apache.再访问<a href="http://localhost/trac">http://localhost/trac</a>看看是不是可以得到trac的默认首页,然后点击&#8221;browse
source&#8221;,你应该可以看到svn仓库里的资源.类似下面这样</p>

<p><img src="/uploads/screen3.png" alt="image" /></p>

<p>随便点击一个源代码文件,可以得到类似下面的界面</p>

<p><img src="/uploads/screen4.png" alt="image" /></p>

<p>不知道是不是需要继续配置,浏览源代码时,源代码里的中文不能显示.</p>

<p>到此,全部配置完成,当然这都是采用最简单,缺省的方式配置起来的,有关授权访问没有细化,不过这都是一些再细化的工作了,至少框架搭建起来了.
再配合支持svn的开发工具,比如Eclipse,Komodo,开发起来还是比较有安全感的.</p>
</div>


  <footer>
    <p class="meta">
      
  

<span class="byline author vcard">Posted by <span class="fn">wgzhao</span></span>

      








  


<time datetime="2007-08-29T00:00:00+08:00" pubdate data-updated="true"></time>
      

<span class="categories">
  
    <a class='category' href='//categories/webkai-fa/'>WEB开发</a>
  
</span>


    </p>
    
      <div class="sharing">
  
  <a href="//twitter.com/share" class="twitter-share-button" data-url="http://wgzhao.github.io/2007/08/29/configure-apache-svn-trac/" data-via="mlsx" data-counturl="http://wgzhao.github.io/2007/08/29/configure-apache-svn-trac/" >Tweet</a>
  
  
  
</div>

    
    <p class="meta">
      
        <a class="basic-alignment left" href="/2007/08/19/male-promble-or-female/" title="Previous Post: 男人的问题还是女人的问题">&laquo; 男人的问题还是女人的问题</a>
      
      
        <a class="basic-alignment right" href="/2007/09/01/Absurd-dream/" title="Next Post: 荒唐梦">荒唐梦 &raquo;</a>
      
    </p>
  </footer>
</article>

  <section>
    <h1>Comments</h1>
    <div id="disqus_thread" aria-live="polite"><noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</div>
  </section>

</div>

<aside class="sidebar">
  
    <section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/2014/03/16/move-to-github/">Move to Github</a>
      </li>
    
      <li class="post">
        <a href="/2012/12/30/some-tips-for-mac-os-x/">一些Mac OS X 的使用技巧</a>
      </li>
    
      <li class="post">
        <a href="/2012/08/24/generate-random-strings-and-other-tips-on-postgresql/">生成随机字符串以及自动更新时间戳和返回最近插入的ID号</a>
      </li>
    
      <li class="post">
        <a href="/2012/08/22/some-way-to-io-statistics-on-linux/">Linux下的一些I/O统计工具</a>
      </li>
    
      <li class="post">
        <a href="/2012/08/21/explaining-the-postgresql-query-optimizer/">PostgreSQL查询优化简介</a>
      </li>
    
  </ul>
</section>

<section>
  <h1>GitHub Repos</h1>
  <ul id="gh_repos">
    <li class="loading">Status updating...</li>
  </ul>
  
  <a href="https://github.com/wgzhao">@wgzhao</a> on GitHub
  
  <script type="text/javascript">
    $(document).ready(function(){
        if (!window.jXHR){
            var jxhr = document.createElement('script');
            jxhr.type = 'text/javascript';
            jxhr.src = '/javascripts/libs/jXHR.js';
            var s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(jxhr, s);
        }

        github.showRepos({
            user: 'wgzhao',
            count: 0,
            skip_forks: true,
            target: '#gh_repos'
        });
    });
  </script>
  <script src="/javascripts/github.js" type="text/javascript"> </script>
</section>


<section>
  <h1>On Delicious</h1>
  <div id="delicious"></div>
  <script type="text/javascript" src="http://feeds.delicious.com/v2/json/wgzhao?count=3&amp;sort=date&amp;callback=renderDeliciousLinks"></script>
  <p><a href="http://delicious.com/wgzhao">My Delicious Bookmarks &raquo;</a></p>
</section>

  
</aside>


    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2014 - wgzhao -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
  

<script type="text/javascript">
      var disqus_shortname = 'wgzhao';
      
        
        // var disqus_developer = 1;
        var disqus_identifier = 'http://wgzhao.github.io/2007/08/29/configure-apache-svn-trac/';
        var disqus_url = 'http://wgzhao.github.io/2007/08/29/configure-apache-svn-trac/';
        var disqus_script = 'embed.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = '//' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>







  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = '//platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>





</body>
</html>
