
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>\[/sbin学习\]f\*命令 - Linux系统管理</title>
  <meta name="author" content="wgzhao">

  
  <meta name="description" content="/sbin 下 f 开头的命令如下 fdisk fixfiles fsck.cramfs fsck.ext3 fsck.ocfs2 fsck.vfat fuser findfs
fsck fsck.ext2 fsck.msdos fsck.reiserfs fsck.xfs fxload 其中 &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://wgzhao.github.io/2007/02/05/commands-start-f">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="/atom.xml" rel="alternate" title="Linux系统管理" type="application/atom+xml">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
  <script>!window.jQuery && document.write(unescape('%3Cscript src="./javascripts/libs/jquery.min.js"%3E%3C/script%3E'))</script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="//fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="//fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<style>
div.entry-content > p, section > p, blockquote > p {text-indent: 2em;}
code {text-indent: 0em;}
div.entry-content > p:first-of-type {text-indent: 0em;}
div.entry-content > p:first-of-type:first-letter
  {font-size:180%;font-weight:bold;}
</style>

  

</head>

<body   >
  <header role="banner"><hgroup>
  <h1><a href="/">Linux系统管理</a></h1>
  
    <h2>关注Linux系统管理，运维开发以及大数据</h2>
  
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="https://www.google.com.hk/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:wgzhao.github.io" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/">Home</a></li>
  <li><a href="/archives">Archives</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div>
<article class="hentry" role="article">
  
  <header>
    
      <h1 class="entry-title">\[/sbin学习\]f\*命令</h1>
    
    
      <p class="meta">
        








  


<time datetime="2007-02-05T00:00:00+08:00" pubdate data-updated="true"></time>
        
           | <a href="#disqus_thread"
             data-disqus-identifier="http://wgzhao.github.io">Comments</a>
        
      </p>
    
  </header>


<div class="entry-content"><p>/sbin 下 f 开头的命令如下</p>

<blockquote><p>fdisk fixfiles fsck.cramfs fsck.ext3 fsck.ocfs2 fsck.vfat fuser findfs<br/>
fsck fsck.ext2 fsck.msdos fsck.reiserfs fsck.xfs fxload</p></blockquote>

<p>其中 fsck.reiserfs 是 reiserfsck 命令的软连接，f 开头的命令中 fsck 命令套件占了绝大部分。
findfs:根据标签(label)或者 UUID 号来查询文件系统。他会搜索整个磁盘，看是否有匹配的标签或者 UUID 没有，如果有，则打印到标注输出上。他也是 <a href="http://e2fsprogs.sf.net">e2fsprogs</a> 项目的一部分。</p>

<!--more-->


<p>一个简单的例子：</p>

<pre><code>[root@lancy sbin]# findfs –help
Usage: findfs LABEL=|UUID=
[root@lancy sbin]# findfs LABEL=/
/dev/hda5
[root@lancy sbin]# findfs LABEL=/home
findfs: Unable to resolve 'LABEL=/home'
</code></pre>

<p>我没有搞清楚这个命令到底有什么用或者应该在什么情况下使用？因为知道 LABEL 或者 UUID 并不像平常知道某一个文件那样容易记住。所以他和 find 的使用范围相比，就小了很多了，难道他有意想不到的用途？</p>

<p>fixfiles:  修复文件安全上下文(security contexts)。这是一个 shell 脚本，主要是用来校正文件系统上的安全上下文数据库（扩展属性）。仔细看了帮助，也作了一些测试，没有明白他要表达什么，刚开始以为是他会恢复我原来修改过某些配置文件到初始状态，当经过测试，似乎不是这回事。所属于 policycoreutils
RPM 包，这是 SELinux 的一部分。</p>

<p>一直以来 SElinux 都没有怎么用过，据说非常难配置，&lt;sf.net>上记得一个项目就是做 SELinux 的配置文件前端。看了从国防出来的产品还真的蛮复杂的。唯一的一次使用了 SELinux 是在一次安装 FC4 的过程中，问我是否打开 SELinux，我想既然是完全，那就用吧。因此打开了。安装后，马上要和其他电脑联网，主要要从别人的机器上 copy 东西到我的电脑上，首先使用 ftp 模式，打开默认的 vsftp，用普通动帐号登录，看上去一切正常，但是就是没有办法写入，以为是配置问题，于是把配置文件折腾个底朝天，结果还是无法写入。放弃，改用 SMB 共享，结果一样，无论我如何指定<code>writable=yes</code>，就是无法写入。最后还是要别人共享，copy 过来的。当时没有往这个方面想，因为人很着急，回来后，重启 Linux，启动过程看到了 enable SELinux 一项，于是马上想到，肯定是这个该死的东西，也没有去想如何配置了，直接 disable 了。</p>

<p>fuser：使用文件或者套节字来表示识别进程。我常用的他的两个功能：查看我需要的进程和我要杀死我查到的进程。比如当你想 umount 光驱的时候，结果系统提示你设备正在使用或者正忙，可是你又找不到到底谁使用了他。这个时候 fuser 可派上用场了。</p>

<pre><code>[root@lancy sbin]# eject
umount: /media/cdrom: device is busy
umount: /media/cdrom: device is busy
eject: unmount of `/media/cdrom' failed
[root@lancy sbin]# fuser /mnt/cdrom
/mnt/cdrom: 4561c 5382c
[root@lancy sbin]# ps -ef |egrep '(4561|5382)' |grep -v grep
root 4561 4227 0 20:13 pts/1 00:00:00 bash
root 5382 4561 0 21:42 pts/1 00:00:00 vim Autorun.inf
</code></pre>

<p>示例中，我想弹出光驱，系统告诉我设备忙着，于是采用 fuser 命令，参数是你文件或 scoket，fuser 将查出那些使用了他。
4561c,5382c 表示目前用两个进程在占用着/mnt/cdrom，分别是 4561,5382,进程 ID 后的字母表示占用资源的方式，有下面几种表示：</p>

<p> c 当前路径(current directory.)我的理解是表示这个资源的占用是以文件目录方式，也就是进进入了需要释放的资源的路径，这是最常用的资源占用方式。 <br/>
e 正在运行可执行文件（executable being run.），比如运行了光盘上的某个程序 <br/>
f 打开文件（ open file），缺省模式下 f 忽略。所以上面的例子中，虽然是开打了光盘上的 Autorun.inf 文件，但是给出的标识是 c，而不是 f。 r
root 目录（root directory）.没有明白什么意思，难道是说进入了/root 这个特定目录？<br/>
m mmap 文件或者共享库( mmap’ed file or shared library).这应该是说某个进程使用了你要释放的资源的某个共享文件。</p>

<p>在查找的同时，你还可定指定一些参数，比如</p>

<p> -k 杀死这些正在访问这些文件的进程。除非使用-signal 修改信号，否则将发送 SIGKILL 信号。 <br/>
 -i 交互模式 <br/>
 -l 列出所有已知的信号名称。 <br/>
 -n 空间，选择不同的名字空间，可是 file,udp,tcp。默认是 file，也就是文件。 <br/>
 -signal 指定发送的信号，而不是缺省的 SIGKILL <br/>
 -4 仅查询 IPV4 套接字 <br/>
 -6 仅查询 IPV6 套接字 <br/>
 &ndash; 重置所有的选项，将信息设回 SIGKILL</p>

<p>再看下面的例子</p>

<pre><code>[root@lancy sbin]# fuser -l
HUP INT QUIT ILL TRAP ABRT IOT BUS FPE KILL USR1 SEGV USR2 PIPE ALRM TERM
STKFLT CHLD CONT STOP TSTP TTIN TTOU URG XCPU XFSZ VTALRM PROF WINCH IO PWR SYS
UNUSED
</code></pre>

<p>现在我们试试 fuser -k 的威力：</p>

<pre><code>root@lancy sbin]# fuser -k /mnt/cdrom
/mnt/cdrom: 4561c 5382c
kill 5382: 没有那个进程
No automatic removal. Please use umount /media/cdrom
[root@lancy sbin]# eject
</code></pre>

<p>套节字方式的使用：</p>

<pre><code>[root@lancy sbin]# fuser -4 -n tcp 3306
here: 3306
3306/tcp: 5595
[root@lancy sbin]# ps -ef |grep 5595 |grep -v grep
mysql 5595 5563 0 22:24 pts/0 00:00:00 /usr/libexec/mysqld –defaults-file=/etc/my.cnf –basedir=/usr –datadir=/var/lib/mysql –user=mysql –pid-file=/var/run/mysqld/mysqld.pid –skip-locking –socket=/var/lib/mysql/mysql.sock


[root@lancy sbin]# fuser -4 -n tcp 80
here: 80
80/tcp: 5685 5688 5689 5690 5691 5692 5693 5694 5695
</code></pre>

<p>fxload:为 EZ-USB 设别下载 firmware。剩下的就是有关磁盘检查的 fsck 命令集了，这么命令的用法和 e2fsck 类似.</p>
</div>


  <footer>
    <p class="meta">
      
  

<span class="byline author vcard">Posted by <span class="fn">wgzhao</span></span>

      








  


<time datetime="2007-02-05T00:00:00+08:00" pubdate data-updated="true"></time>
      

<span class="categories">
  
    <a class='category' href='/categories/linuxji-zhu/'>Linux技术</a>
  
</span>


    </p>
    
      <div class="sharing">
  
  <a href="//twitter.com/share" class="twitter-share-button" data-url="http://wgzhao.github.io/2007/02/05/commands-start-f/" data-via="mlsx" data-counturl="http://wgzhao.github.io/2007/02/05/commands-start-f/" >Tweet</a>
  
  
  
    <div class="fb-like" data-send="true" data-width="450" data-show-faces="false"></div>
  
</div>

    
    <p class="meta">
      
        <a class="basic-alignment left" href="/2007/02/03/Linux-memory-repeat-simple-calculation/" title="Previous Post: 再说Linux内存简单计算">&laquo; 再说Linux内存简单计算</a>
      
      
        <a class="basic-alignment right" href="/2007/02/09/commands-start-g/" title="Next Post: \[/sbin学习\] g\*命令">\[/sbin学习\] g\*命令 &raquo;</a>
      
    </p>
  </footer>
</article>

  <section>
    <h1>Comments</h1>
    <div id="disqus_thread" aria-live="polite"><noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</div>
  </section>

</div>

<aside class="sidebar">
  
    <section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/2014/03/18/compile-tmux-1-dot-9a-statically/">静态编译tmux 1.9a版本</a>
      </li>
    
      <li class="post">
        <a href="/2014/03/16/move-to-github/">Move to Github</a>
      </li>
    
      <li class="post">
        <a href="/2012/12/30/some-tips-for-mac-os-x/">一些Mac OS X 的使用技巧</a>
      </li>
    
      <li class="post">
        <a href="/2012/08/24/generate-random-strings-and-other-tips-on-postgresql/">生成随机字符串以及自动更新时间戳和返回最近插入的ID号</a>
      </li>
    
      <li class="post">
        <a href="/2012/08/22/some-way-to-io-statistics-on-linux/">Linux下的一些I/O统计工具</a>
      </li>
    
  </ul>
</section>
<section>
<h1>QR-Code</h1>
<a href="/2007/02/05/commands-start-f/"><img src="http://chart.apis.google.com/chart?chs=150x150&cht=qr&chld=|0&chco=165B94&chl=/2007/02/05/commands-start-f/" alt="post-qrcode"></a></section>
<section>
  <h1>Categories</h1>
    <ul id="category-list"><li><a href='/categories/linuxji-zhu/'>Linux技术 (152)</a></li><li><a href='/categories/webkai-fa/'>WEB开发 (6)</a></li><li><a href='/categories/wo-du-wo-shu/'>我读我书 (16)</a></li><li><a href='/categories/ji-zhu-ji-qiao/'>技术技巧 (29)</a></li><li><a href='/categories/shu-ju-ku/'>数据库 (8)</a></li><li><a href='/categories/sui-xin-suo-xiang/'>随心所想 (113)</a></li></ul>
</section>

  
</aside>


    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2014 - wgzhao -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
  

<script type="text/javascript">
      var disqus_shortname = 'wgzhao';
      
        
        // var disqus_developer = 1;
        var disqus_identifier = 'http://wgzhao.github.io/2007/02/05/commands-start-f/';
        var disqus_url = 'http://wgzhao.github.io/2007/02/05/commands-start-f/';
        var disqus_script = 'embed.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = '//' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>



<div id="fb-root"></div>
<script>(function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0];
  if (d.getElementById(id)) {return;}
  js = d.createElement(s); js.id = id; js.async = true;
  js.src = "//connect.facebook.net/en_US/all.js#appId=212934732101925&xfbml=1";
  fjs.parentNode.insertBefore(js, fjs);
}(document, 'script', 'facebook-jssdk'));</script>





  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = '//platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>





</body>
</html>
