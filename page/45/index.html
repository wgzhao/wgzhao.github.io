
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Linux系统管理</title>
  <meta name="author" content="wgzhao">

  
  <meta name="description" content="假设你用的字体是 /usr/share/fonts/zh_CN/TrueType/rfdw.ttf #cd /path/to/jre/lib/fonts #mkdir fallback #cd fallback #ln -s /usr/share/fonts/zh_CN/TrueType/rfdw &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://wgzhao.github.io/page/45">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="/atom.xml" rel="alternate" title="Linux系统管理" type="application/atom+xml">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
  <script>!window.jQuery && document.write(unescape('%3Cscript src="./javascripts/libs/jquery.min.js"%3E%3C/script%3E'))</script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="//fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="//fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">

  

</head>

<body   >
  <header role="banner"><hgroup>
  <h1><a href="/">Linux系统管理</a></h1>
  
    <h2>关注Linux系统管理，运维开发以及大数据</h2>
  
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="https://www.google.com.hk/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:wgzhao.github.io" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/">Blog</a></li>
  <li><a href="/blog/archives">Archives</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div class="blog-index">
  
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/2007/03/23/troubleshooting-jdk15-garbled/">最简单的对JDK1.5的中文乱码处理方法</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2007-03-23T00:00:00+08:00" pubdate data-updated="true"></time>
        
           | <a href="/2007/03/23/troubleshooting-jdk15-garbled/#disqus_thread"
             data-disqus-identifier="http://wgzhao.github.io/2007/03/23/troubleshooting-jdk15-garbled/">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>假设你用的字体是 /usr/share/fonts/zh_CN/TrueType/rfdw.ttf</p>

<p> #cd /path/to/jre/lib/fonts
 #mkdir fallback
 #cd fallback
 #ln -s /usr/share/fonts/zh_CN/TrueType/rfdw.ttf
 #mkfontdir
 #mkfontscale</p>

<p>此方法对JRE也同样有效。</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/2007/03/22/commands-start-m/">\[/sbin学习\]m\*命令</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2007-03-22T00:00:00+08:00" pubdate data-updated="true"></time>
        
           | <a href="/2007/03/22/commands-start-m/#disqus_thread"
             data-disqus-identifier="http://wgzhao.github.io/2007/03/22/commands-start-m/">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>/sbin目录下m开头的命令可不少</p>

<pre><code>mdadm          mii-tool    mkfs.cramfs    mkfs.xfs    mounted.ocfs2  mpath_get_name          multipath.static
mdadm.static   mingetty    mkfs.ext2      mkinitrd    mount.ncp      mpath_prio_alua
mdassemble     minilogd    mkfs.ext3      mkreiserfs  mount.ncpfs    mpath_prio_emc
mdevt          mkbootdisk  mkfs.msdos     mkswap      mount.ocfs2    mpath_prio_hds_modular
mdmpd          mkdosfs     mkfs.ocfs2     mkzonedb    mount.smb      mpath_prio_netapp
mgetty         mke2fs      mkfs.reiserfs  modinfo     mount.smbfs    multipath
microcode_ctl  mkfs        mkfs.vfat      modprobe    mpath_ctl      multipathd
</code></pre>

<p>mkfs系列命令占了很大一部分。 mdadm,mdadm.static:这是和RAID相关的程序，他用来管理Linux下的软RAID。
当前Linux提供的RAID级别有LINEAR md设备，RAID0 (striping),RAID1 (mirroring),RAID4,RAID5,RAID6,MULTIPATH和FAULTY.
这里说的multipathq其实并不是软RAID机制中的一部分，但是他会去调用。</p>

</div>
  
  
    <footer>
      <a rel="full-article" href="/2007/03/22/commands-start-m/">Read on &rarr;</a>
    </footer>
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/2007/03/21/return-to-the-redflag/">重回红旗</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2007-03-21T00:00:00+08:00" pubdate data-updated="true"></time>
        
           | <a href="/2007/03/21/return-to-the-redflag/#disqus_thread"
             data-disqus-identifier="http://wgzhao.github.io/2007/03/21/return-to-the-redflag/">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>不想写很多，只是想说一句：</p>

<p>我重新回到了<a href="http://www.redflag-linux.com">红旗</a>，不过不在北京上班，而是在长沙。</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/2007/03/19/commands-start-l/">\[/sbin学习\]l\*命令</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2007-03-19T00:00:00+08:00" pubdate data-updated="true"></time>
        
           | <a href="/2007/03/19/commands-start-l/#disqus_thread"
             data-disqus-identifier="http://wgzhao.github.io/2007/03/19/commands-start-l/">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>/sbin/下l开头的命令不多，列举如下：</p>

<blockquote><p>ldconfig lilo logsave loopctrl losetup lsmod lspci lsusb lvm lvm.static</p></blockquote>

<p>其中lvm是lvm.static的软连接。</p>

<p>ldconfig：配置动态连接库，以便程序在编译和运行中动态连接这些程序库。与此相关的配置文件便是/etc/ld.so.conf，后来的ldconfig的配置文件采取了现在流行的读取目录下的配置文件。所以/etc/ld.so.conf.d目录便是后来增加的。
我仅仅使用ldconfig的一个参数-f，就是指定配置文件，这样的好处是，当我需要增加某一个目录的动态库时，我不要全部重建动态库缓存，命令程序运行时间短了很多。</p>

</div>
  
  
    <footer>
      <a rel="full-article" href="/2007/03/19/commands-start-l/">Read on &rarr;</a>
    </footer>
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/2007/03/17/i-winning/">中奖了，中奖了！</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2007-03-17T00:00:00+08:00" pubdate data-updated="true"></time>
        
           | <a href="/2007/03/17/i-winning/#disqus_thread"
             data-disqus-identifier="http://wgzhao.github.io/2007/03/17/i-winning/">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>感谢母亲在28年前的今天，忍受了人生最大的痛苦，生育了我！<br/>
中午，lancy请我吃饭。随便点了几个菜，边聊边吃，结账时，顺便要了一张发票。<br/>
习惯性的刮着，虽然从来都没有中奖过，但是还是期望奇迹发现。<br/>
我是从中间刮起，随便刮了点，瞄了一眼，觉得出现的这个字好陌生呀，因为平常挂出来都是“付税光荣”，这次似乎不像“税”，也不像“光”，再看，是个“拾”字，我马上对lancy说，中奖了，lancy不相信，说我骗她，我继续刮，前面居然是一个“伍”字，我兴奋的说”中奖了，伍拾呢！“，旁边的服务员也不相信，顺口说了一句”是付税光荣“，估计是他们这里还没有发现有人中奖过吧。</p>

<p>lancy看我不像是骗她，立马抢了过去，再刮了一下，果然是伍拾，哈哈！</p>

<p>lancy高兴的去服务台领奖，旁边的服务员也赶紧围了过来，纷纷说手气不错，赶紧去买六合彩。</p>

<p>这还是我们第一次发票上中奖呢，不容易呀，看这次的好运气能不能给我今年带来好运！</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/2007/03/16/php-class-manipulate-excel/">一个简单的写excel文件的类</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2007-03-16T00:00:00+08:00" pubdate data-updated="true"></time>
        
           | <a href="/2007/03/16/php-class-manipulate-excel/#disqus_thread"
             data-disqus-identifier="http://wgzhao.github.io/2007/03/16/php-class-manipulate-excel/">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>很多web页面有要求将数据保存为excel格式，以满足那些异常喜爱excel的人，老实说，excel确实是很优秀的产品。<br/>
这里的这个类，采用的方法是写xml文件，从office 2003后，office系列增强了对xml文件格式的读写能力，对于简单的excel文件，我们可以简单的写入csv格式文件。稍微复杂的，那就采用表格的方式吧，比如下面的这个类</p>

</div>
  
  
    <footer>
      <a rel="full-article" href="/2007/03/16/php-class-manipulate-excel/">Read on &rarr;</a>
    </footer>
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/2007/03/15/oracle-performance-tuning-system-part/">Oracle性能调优&#8211;系统篇</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2007-03-15T00:00:00+08:00" pubdate data-updated="true"></time>
        
           | <a href="/2007/03/15/oracle-performance-tuning-system-part/#disqus_thread"
             data-disqus-identifier="http://wgzhao.github.io/2007/03/15/oracle-performance-tuning-system-part/">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Oracle数据库的性能优化调整是一个系统工程，涉及的方面很多。oracle在操作系统的调优主要是在调整oracle的操作系统参数和内存参数，系统调优分两个阶段：安装化阶段和运行阶段。</p>

<p><strong>一、在安装化阶段</strong></p>

<p>一般在安装生产数据库时，我们根据系统最早的规划，集合软、硬件环境，需要调整操作系统以及数据库参数，
&lt;1&mdash;more&mdash;>
<strong>1、操作系统交换区</strong></p>

<p>交换区是Oracle的一项基本的要求。可以根据Oracle的发行要求来确定。一般交换区大小的要求是该服务器内存的2倍至4倍之间，建议是内存的4倍</p>

<p><strong>2、操作系统内核参数</strong></p>

<p>下表给出了OS的参数设置及说明，可以根据实际需要对这些参数进行设置</p>

<p><strong>内核参数名</strong></p>

<p><strong>说明</strong></p>

<p><strong>bufpages</strong></p>

<p>对buffer空间不按静态分配，采用动态分配，使bufpages值随nbuf一起对buffer空间进行动态分配。</p>

<p><strong>create_fastlinks</strong></p>

<p>对HFS文件系统允许快速符号链接</p>

<p><strong>dbc_max_pct</strong></p>

<p>加大最大动态buffer空间所占物理内存的百分比，以满足应用系统的读写命中率的需要。</p>

<p><strong>dbc_min_pct</strong></p>

<p>设置最小动态buffer空间所占物理内存的百分比</p>

<p><strong>desfree</strong></p>

<p>提高开始交换操作的最低空闲内存下限，保障系统的稳定性，防止出现不可预见的系统崩溃(Crash)。</p>

<p><strong>fs_async</strong></p>

<p>允许进行磁盘异步操作，提高CPU和磁盘的利用率</p>

<p><strong>lotsfree</strong></p>

<p>提高系统解除换页操作的空闲内存的上限值，保证应用程序有足够的可用内存空间。</p>

<p><strong>maxdsiz</strong></p>

<p>针对系统数据量大的特点，加大最大数据段的大小，保证应用的需要。(32位)</p>

<p><strong>maxdsiz_64bit</strong></p>

<p>maximum process data segment size for 64_bit</p>

<p><strong>Maxssiz</strong></p>

<p>加大最大堆栈段的大小。(32_bit)</p>

<p><strong>maxssiz_64bit</strong></p>

<p>加大最大堆栈段的大小。(64_bit)</p>

<p><strong>Maxtsiz</strong></p>

<p>提高最大代码段大小，满足应用要求</p>

<p><strong>maxtsiz_64bit</strong></p>

<p>原值过大，应调小</p>

<p><strong>Minfree</strong></p>

<p>提高停止交换操作的自由内存的上限</p>

<p><strong>Shmem</strong></p>

<p>允许进行内存共享，以提高内存的利用</p>

<p><strong>Shmmax</strong></p>

<p>设置最大共享内存段的大小，完全满足目前的需要，建议设大点， 达到最大SGA</p>

<p><strong>shmmin</strong></p>

<p>最小的共享内存段</p>

<p><strong>shmmni</strong></p>

<p>共享内存标志符的数量.</p>

<p><strong>shmseg</strong></p>

<p>一个进程可分配的最大内存段数.</p>

<p><strong>shmall</strong></p>

<p>最大可允许的内存数，比SGA还要大.</p>

<p><strong>semmns</strong></p>

<p>信号量，跟ORACLE的PROCESS数有关</p>

<p><strong>semmsl</strong></p>

<p>一个信号量中最大的信号量数</p>

<p><strong>Timeslice</strong></p>

<p>由于系统的瓶颈主要反映在磁盘I/O上，因此
降低时间片的大小，一方面可避免因磁盘I/O不畅造成CPU的等待，从而提高了CPU的综合利用率。另一方面减少了进程的阻塞量。</p>

<p><strong>unlockable_mem</strong></p>

<p>提高了不可锁内存的大小，使可用于换页和交换的内存空间扩大,用以满足系统对内存管理的要求。</p>

<p><strong>3、oracle文件设置</strong></p>

<p>当服务器平台已完成操作系统的安装后，就应该开始认真的考虑下面的问题：</p>

<p><strong>A、是否采用裸设备</strong></p>

<p>实际应用的生产系统基本都是采用裸设备，使用裸设备对于读写频繁的数据库应用来说，可以极大地提高数据库系统的性能。</p>

<p><strong>B、安装点的考虑</strong></p>

<p>Oracle的安装点就是指数据文件、日志文件和控制文件的安置路径，为了使系统在以后运行性能达到优化，建议将数据文件、日志文件和控制文件的安置路径与数据库系统存放在不同的路径上。最好将数据文件、日志文件和控制文件分别存放在不同的路径。</p>

<p><strong>C、SYSTEM表空间对应数据文件</strong></p>

<p>在自定义安装会话中，建议你根据需要设置system表空间所对应的数据文件的大小。一般要设置比默认值的2倍。该数据文件的大小最好是在300MB至500MB间。因为数据文件太小不利于系统的运行。</p>

<p><strong>D、临时表空间对应的数据文件</strong></p>

<p>临时表空间对应的数据文件可以根据将来系统存放的应用的处理情况来定。比如系统将来可能要经常进程排序处理，则需要设置较大的临时表空间，也可能需要再建立新的临时表空间。这里建议临时表空间的数据文件在100MB至300MB左右。</p>

<p><strong>E、回滚段表空间对应的数据文件</strong></p>

<p>回滚表空间都是系统管理，初始值也是根据系统事务量预估计的值，实际到运行阶段如果系统常出现ORA-01555错误的时候，可能就需要增加回滚表空间的大小。</p>

<p><strong>F、日志文件的大小</strong></p>

<p>日志文件的大小对于Oracle系统的运行也是相当重要。默认值是太小。实际根据事务繁忙预估计日志大小，没有固定的具体值范围，建议重做日志切换时间不能过短也不能过长，一般在20－40分钟左右。该参数可以在系统运行期间根据数据库系统日志切换时间重新调整，控制文件的大小。</p>

<p><strong>G、数据库块的大小</strong></p>

<p>如果你的应用系统是OLTP的话，可以采用较小的数据库块。如果是DSS类型的应用系统，则可以设置较大的数据库块，目前Oracle产品所允许的数据库块可以是2KB至64KB之间。无论你选择较大的块或较小的块，它的值都必须是2的整数倍，比如2048,4096,8192等。但需要注意的是，如果操作系统为64位，则可选择较大的块。</p>

<p><strong>H、字符集的选择</strong></p>

<p>字符集是Oracle系统专门支持的一项技术。详细请参考另外的章节。一般不要与另外的已经存放的Oracle系统的字符集产生冲突即可。但如果你的环境是一个新的平台，不需要与其它平台进行数据交换的话，建议选择默认的字符集。这样可以利于将来的修改。</p>

<p><strong>4、数据库启动参数（SGA内参数）</strong></p>

<p>oracle的内存可以按照共享和私有的角度分为系统全局区和进程全局区，也就是SGA和PGA (process global area or
private global area)。对于SGA区域内的内存来说，是共享的全局的，在linux
上，必须为oracle设置共享内存段（可以是一个或者多个），因为oracle在linux上是多进程；而在windows上oracle是单进程（多个线程），所以不用设置共享内存段。PGA是属于进程（线程）私有的区域。在oracle使用共享服务器模式下（MTS）,PGA中的一部分，也就是UGA会被放入共享内存large_pool_size中。内存参数的调整主要是指Oracle数据库的系统全局区（SGA）的调整。SGA主要由3部分构成：共享池、数据缓冲区、日志缓冲区。</p>

<p><strong>启动参数</strong></p>

<p><strong>说明</strong></p>

<p><strong>sga_max_size</strong></p>

<p>例程存活期间所占用的系统全局区的最大大小，一般为物理内存的1/2-1/3</p>

<p><strong>shared_pool_size</strong></p>

<p>指定共享池的大小，共享池包含：共享游标、存储的过程、控制结构和并行执行消息缓冲区等对象。这部分内存的作用，它是为了缓存已经被解析过的sql，而使其能被重用，不再解析。这样做的原因是因为，对于一个新的sql
（shared_pool里面不存在已经解析的可用的相同的sql），数据库将执行硬解析，这是一个很消耗资源的过程。而若已经存在，则进行的仅仅是软分析（在共享池中寻找相同sql），这样消耗的资源大大减少。所以我们期望能多共享一些sql，并且如果该参数设置不够大，经常会出现ora-04031错误，表示为了解析新的sql，没有可用的足够大的连续空闲空间，这样自然我们期望该参数能大一些。但是该参数的增大，却也有负面的影响，因为需要维护共享的结构，内存的增大也会使得sql的老化的代价更高，带来大量的管理的开销，所有这些可能会导致cpu的严重问题。</p>

<p>在一个充分使用绑定变量的比较大的系统中，shared_pool_size的开销通常应该维持在300M以内。除非系统使用了大量的存储过程、函数、包，比如oracle
ERP这样的应用，可能会达到500M甚至更高。一般是在200M-500M左右,假定一个1G内存的系统，可能考虑设置该参数为100M，2G的系统考虑设置为150M,8G的系统可以考虑设置为200—300M。但是通常我们不主张这部分内存超过800M（特殊情况下可以更大）。</p>

<p><strong>db_cache_size</strong></p>

<p>该参数指定数据缓冲区的大小，原则上时越大越好，取代了8i中的db_block_size * db_block_buffers</p>

<p><strong>db_block_buffers</strong></p>

<p>(数据高速缓冲区)访问过的数据都放在这一片内存区域，该参数越大，Oracle在内存中找到相同数据的可能性就越大，也即加快了查询速度。</p>

<p><strong>db_block_size</strong></p>

<p>(数据库块大小):Oracle默认块为2KB，太小了，因为如果我们有一个8KB的数据，则2KB块的数据库要读4次盘，才能读完，而8KB块的数据库只要1次就读完了，大大减少了I/O操作。数据库安装完成后，就不能再改变db_block_size的值了，只能重新建立数据库并且建库时，要选择手工安装数据库。</p>

<p><strong>log_buffer</strong></p>

<p>重做日志缓冲区大小，该参数设置大没有意义，Oracle推荐log_buffer最大为cpu_count乘以128KB或512KB中最大值,
通常超过3MB意义不是很大, 可能考虑先设置这部分为log_buffer=1—3M B大小，然后针对具体情况再调整。</p>

<p><strong>processes</strong></p>

<p>(同时连接的进程数)系统用户进程的最大数量，该参数设置为系统最繁忙时估计并发用户数</p>

<p><strong>large_pool_size</strong></p>

<p>如果不设置MTS，通常在 RMAN 、OPQ 会使用到，但是在20M &mdash;50M应该差不多了。可以考虑为 session *
(sort_area_size + 2M)。</p>

<p><strong>Java_pool_size</strong></p>

<p>它用于存放java代码，对于大的应用，java_pool_size应>=50M，对于一般的java存储过程，缺省为20M。若不使用java，建议设置为30M</p>

<p><strong>pga_aggregate_target</strong></p>

<p>程序全局区大小,</p>

<p>1.对于OLTP系统PGA_AGGREGATE_TARGET = （<Total Physical Memory > * 80%） *
20%</p>

<p>2.对于DSS系统PGA_AGGREGATE_TARGET = （<Total Physical Memory > * 80%） *
50%</p>

<p><strong>timed_statistics</strong></p>

<p>建议将timed_statistics 设置为true,否则无法查看到准确的统计信息（9i版本后的设置为true对系统性能影响较小，千分之一）</p>

<p>*查看：sql> show parameters sga_max_size</p>

<p>*修改：sql>alter system set sga_max_size = 30000000；重启数据库生效</p>

<p>上述参数基本是初始估计值，在运行阶段可能会根据实际运行情况再调整。</p>

<p><strong>二、运行阶段</strong></p>

<p>在运行阶段，关于参数调整，是oracle的复杂性的一个具体体现。通常来讲，我们更倾向于让客户做awrrpt报告，然后告诉我们操作系统监控的状况，在这些的信息的基础上，再向客户索取具体的详细信息以诊断问题的所在。系统的调整，现在我们通常采用从等待事件入手的方法。因为一个系统感觉到慢，必然是在某个环节上出现等待，那么我们从等待最多的事件入手逐步诊断并解决问题。</p>

<p>对于内存的调整，相对来说简单一些，我们首先可以针对数据缓冲区的大小来看。首先观察命中率</p>

<p><strong>1、数据缓冲区命中率</strong></p>

<p>sql> select value from v$sysstat where name =’physical reads’；</p>

<p>value</p>

<p>14764</p>

<p>sql> select value from v$sysstat where name =’physical reads direct’；</p>

<p>value</p>

<p>50</p>

<p>sql> select value from v$sysstat where name =’physical reads direct
(lob)’；</p>

<p>value</p>

<p>0</p>

<p>sql> select value from v$sysstat where name =’consistent gets’；</p>

<p>value</p>

<p>167763</p>

<p>sql> select value from v$sysstat where name = ’db block gets’；</p>

<p>value</p>

<p>14305</p>

<p>这里命中率的计算应该是</p>

<p>令 x = physical reads direct + physical reads direct (lob)</p>

<p>命中率 =100 &ndash; ( physical reads &ndash; x) / (consistent gets + db block gets &ndash;
x)*100</p>

<p>通常如果发现命中率低于90%,则应该调整应用可可以考虑是否增大数据缓冲区</p>

<p>2、<strong>共享池的命中率</strong></p>

<p>sql> select sum(pinhits)/sum(pins)*100 &ldquo;hit radio&rdquo; from
v$librarycache；</p>

<p>hit radio</p>

<p>99.809291</p>

<p>假如共享池的命中率低于95%,就要考虑调整应用（通常是没使用bind var ）或者增加内存</p>

<p><strong>3、关于排序部分</strong></p>

<p>sql> select name,value from v$sysstat where name like ’%sort%’；</p>

<p>name value</p>

<hr />

<hr />

<p>sorts(memory) 67935</p>

<p>sorts(disk) 1</p>

<p>sorts(rows) 7070</p>

<p>sql></p>

<p>假如我们发现sorts (disk)/ (sorts (memory)+ sorts
(disk))的比例过高，则通常意味着sort_area_size部分内存较小，可考虑调整相应的参数。</p>

<p><strong>4、关于log_buffer</strong></p>

<p>对应的参数是log_buffer，缺省值与 OS相关，一般是500K。检查v$session_wait中是否存在log buffer
wait,v$sysstat中是否存在redo buffer allocation retries</p>

<p>sql> select name,value from v$sysstat where name in(’redo
entries’,’redo buffer allocation retries’)；</p>

<p>name value</p>

<hr />

<hr />

<p>Red oentries 325719</p>

<p>redo buffer allocation retries 10</p>

<p>假如 redo buffer allocation retries/ redo entries
的比例超过1%我们就可以考虑增大log_buffer</p>

<p><strong>A、检查是否存在log buffer wait：</strong></p>

<p>Select * from v$session_wait where event=’log buffer wait’ ;
如果出现等待，一是可以增加log_buffer的大小，也可以通过将log 文件移到访问速度更快的磁盘来解决。</p>

<p><strong>B、Select name,value from v$sysstat where name in (‘redo buffer
allocation retries’,’redo entries’)</strong></p>

<p>Redo buffer allocation retries接近0，小于redo entries
的1％，如果一直在增长，表明进程已经不得不等待redo buffer的空间。如果Redo buffer allocation
retries过大，增加log_buffer的值。</p>

<p><strong>C、检查日志文件上是否存在磁盘IO竞争现象</strong></p>

<p>Select event,total_waits,time_waited,average_wait from
v$system_event where event like ‘log file switch completion%’;</p>

<p>如果存在竞争，可以考虑将log文件转移到独立的、更快的存储设备上或增大log文件。</p>

<p><strong>D、检查点的设置是否合理</strong></p>

<p>检查alert.log文件中，是否存在‘checkpoint not complete’；</p>

<p>Select event,total_waits,time_waited,average_wait from
v$system_event where event like ‘log file switch (check%’;</p>

<p>如果存在等待，调整log_checkpoint_interval、log_checkpoint_timeout的设置。</p>

<p><strong>E、检查log archiver的工作</strong></p>

<p>Select event,total_waits,time_waited,average_wait from
v$system_event where event like ‘log file switch (arch%’;</p>

<p>如果存在等待，检查保存归档日志的存储设备是否已满，增加日志文件组，调整log_archiver_max_processes。</p>

<p><strong>F、DB_block_checksum=true</strong></p>

<p>DB_block_checksum=true，因此增加了性能负担。（为了保证数据的一致性，oracle的写数据的时候加一个checksum在block上，在读数据的时候对checksum进行验证）</p>

<p><strong>5、java_pool</strong></p>

<p>对于大的应用，java_pool_size应>=50M，对于一般的java存储过程，缺省的20M已经够用了。</p>

<p><strong>6、检查是否需要调整DBWn</strong></p>

<p>Select total_waits from v$system_event where event=’free buffer
waits’;</p>

<p>通常来说，内存的调整的焦点就集中在这几个方面，更多更详细的内容，建议从awrrpt入手来一步一步调整。最后关于内存的调整，再强调这一点，一定要结合操作系统来衡量，任何理论都必须要实践来检验。在操作系统中观察
page in/out 状况，发现问题严重，应该考虑调小SGA。</p>

<p><strong>7、32bit和64bit的问题</strong></p>

<p>对于oracle来说，存在着32bit与64bit的问题。这个问题影响到的主要是sga的大小。在32bit的数据库下，通常oracle只能使用不超过1.7g的内存，即使我们拥有12g的内存，但是我们却只能使用1.7g，这是一个莫大的遗憾。假如我们安装64bit的数据库,我们就可以使用很大的内存，几乎不可能达到上限。但是64bit的数据库必须安装在64bit的操作系统上，可惜目前windows上只能安装32bit的数据库，我们通过下面的方式可以查看数据库是32bit还是64bit：</p>

<pre><code>sql&gt; select * from v$version；
</code></pre>

<p>但是在特定的操作系统下，可能提供了一定的手段，使得我们可以使用超过1.7g的内存，达到2g以上甚至更多。</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/2007/03/12/some-tips-about-group-and-gshadow/">/etc/group,/etc/gshadow释疑</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2007-03-12T00:00:00+08:00" pubdate data-updated="true"></time>
        
           | <a href="/2007/03/12/some-tips-about-group-and-gshadow/#disqus_thread"
             data-disqus-identifier="http://wgzhao.github.io/2007/03/12/some-tips-about-group-and-gshadow/">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>下午<a href="http://weiling00.spaces.live.com/">welling</a>在MSN上问我，你知道/etc/group的第二项是什么意思吗？这项中!和x分别代表什么意思呢？
之前我还真的没有注意到这个问题。于是先man group了一把，给出了的说明是</p>

<blockquote><p>password the (encrypted) group password. If this field is empty, no
password is needed.</p></blockquote>

</div>
  
  
    <footer>
      <a rel="full-article" href="/2007/03/12/some-tips-about-group-and-gshadow/">Read on &rarr;</a>
    </footer>
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/2007/03/11/Abacus/">算盘</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2007-03-11T00:00:00+08:00" pubdate data-updated="true"></time>
        
           | <a href="/2007/03/11/Abacus/#disqus_thread"
             data-disqus-identifier="http://wgzhao.github.io/2007/03/11/Abacus/">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>上午去lancy的办公室，发现桌子上多了一个新式算盘，很是惊讶，因为很久没有看到过这个东西了，拿起来先随便拨了拨珠子，手感还可以，就是紧了点，于是尝试着打一打小时候经常玩的666，也就是从1加到36，到底是许久没有接触算盘了，开始几次总是不对，打了好几次后，才正确一次，不过慢慢的，也找到了感觉，又开始打5050（从1加到100），速度还算可以。</p>

</div>
  
  
    <footer>
      <a rel="full-article" href="/2007/03/11/Abacus/">Read on &rarr;</a>
    </footer>
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/2007/03/09/today-left-5460/">今日离开中国同学录</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2007-03-09T00:00:00+08:00" pubdate data-updated="true"></time>
        
           | <a href="/2007/03/09/today-left-5460/#disqus_thread"
             data-disqus-identifier="http://wgzhao.github.io/2007/03/09/today-left-5460/">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>下午5：40，打印出了离职报告，交给了部门经理，签字后又转移到总监手里。<br/>
至此，我在<a href="http://www.5460.net" title="中国同学录">中国同学录</a> <br/>
的工作告一段落了。这是我在回长沙后的第二份工作，第一份工作工作了5天，因为规定周六要上班和需要缴纳3000元的保证金而离开了。</p>

<p>而现在的这份工作，我上了58天班，因为公司的体制和一些做人做事的方法，让我无法适应而离开。
不过就在准备离开的这两天，其实发生了很多事情，让我看到了一些平常我看不到的层面，只是觉得有点晚，因为之前我已经决定走了。</p>

<p>有时我觉得我是不是过于挑剔或者过于自大了？是不是应该放下自己其实就没有资格有的臭架子，可是往往我有无法强迫自己去认同那些我不习惯的东西。</p>

<p>我不习惯在办公室这样的公共场合还有人吸烟；我不习惯在办公室总是充斥着污言秽语和大肆喧哗；我不习惯成天的开会，虽然我并不要参加；我不习惯虽然说不提倡加班，但事实却不是这样。</p>

<p>也许潜意识里，我还是热爱着Linux，我已经在公司被windows压抑得几乎无法呼吸。我渴望自由！</p>
</div>
  
  


    </article>
  
  <div class="pagination">
    
      <a class="prev" href="/page/46/">&larr; Older</a>
    
    <a href="/blog/archives">Blog Archives</a>
    
    <a class="next" href="/page/44/">Newer &rarr;</a>
    
  </div>
</div>
<aside class="sidebar">
  
    <section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/2013/01/14/block-youku-ads-cleanly/">彻底屏蔽优酷广告</a>
      </li>
    
      <li class="post">
        <a href="/2012/12/30/some-tips-for-mac-os-x/">一些Mac OS X 的使用技巧</a>
      </li>
    
      <li class="post">
        <a href="/2012/08/24/generate-random-strings-and-other-tips-on-postgresql/">生成随机字符串以及自动更新时间戳和返回最近插入的ID号</a>
      </li>
    
      <li class="post">
        <a href="/2012/08/22/some-way-to-io-statistics-on-linux/">Linux下的一些I/O统计工具</a>
      </li>
    
      <li class="post">
        <a href="/2012/08/21/explaining-the-postgresql-query-optimizer/">PostgreSQL查询优化简介</a>
      </li>
    
  </ul>
</section>

<section>
  <h1>GitHub Repos</h1>
  <ul id="gh_repos">
    <li class="loading">Status updating&#8230;</li>
  </ul>
  
  <a href="https://github.com/wgzhao">@wgzhao</a> on GitHub
  
  <script type="text/javascript">
    $(document).ready(function(){
        if (!window.jXHR){
            var jxhr = document.createElement('script');
            jxhr.type = 'text/javascript';
            jxhr.src = '/javascripts/libs/jXHR.js';
            var s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(jxhr, s);
        }

        github.showRepos({
            user: 'wgzhao',
            count: 0,
            skip_forks: true,
            target: '#gh_repos'
        });
    });
  </script>
  <script src="/javascripts/github.js" type="text/javascript"> </script>
</section>


<section>
  <h1>On Delicious</h1>
  <div id="delicious"></div>
  <script type="text/javascript" src="http://feeds.delicious.com/v2/json/wgzhao?count=3&amp;sort=date&amp;callback=renderDeliciousLinks"></script>
  <p><a href="http://delicious.com/wgzhao">My Delicious Bookmarks &raquo;</a></p>
</section>

  
</aside>

    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2014 - wgzhao -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
  

<script type="text/javascript">
      var disqus_shortname = 'wgzhao';
      
        
        var disqus_script = 'count.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = '//' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>







  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = '//platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>





</body>
</html>
